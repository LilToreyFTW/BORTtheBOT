(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[461],{2651:function(e,t,n){Promise.resolve().then(n.bind(n,5175))},5175:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b},dynamic:function(){return m}});var i,a=n(2495),r=n(8082),o=n(8984),l=n(265),d=n(5545),s=n(655),c=n(1474),u=n(4661),p=n(8389);let m="force-dynamic",h=(0,u.default)(()=>Promise.all([n.e(767),n.e(405),n.e(291)]).then(n.bind(n,9291)).then(e=>e.PrinterViewerWrapper),{loadableGenerated:{webpack:()=>[9291]},ssr:!1}),y=(0,u.default)(()=>Promise.all([n.e(767),n.e(405),n.e(457)]).then(n.bind(n,4457)).then(e=>e.RobotSimWrapper),{loadableGenerated:{webpack:()=>[4457]},ssr:!1}),v=(0,s.BJ)({links:[(0,s.N8)({url:"".concat(null!==(i=p.env.NEXT_PUBLIC_SERVER_URL)&&void 0!==i?i:"http://localhost:3000","/trpc"),fetch:(e,t)=>fetch(e,{...t,credentials:"include"})})]});function f(e){return(0,o.D)({mutationFn:t=>v.mutation(e,t)})}function g(){var e,t,n;let i=(t="bots.list",(0,r.a)({queryKey:["trpc",t,void 0],queryFn:()=>v.query(t,n)})),o=f("bots.create"),l=f("bots.remove"),d=f("bots.updateSpecs"),s=f("bots.calibratePrinter"),u=f("programs.upsert"),m=f("programs.createDownloadToken"),g=(0,c.useRef)(null),b=(0,c.useRef)(null),x=async()=>{var e,t,n,a;let r=(null===(t=g.current)||void 0===t?void 0:null===(e=t.value)||void 0===e?void 0:e.trim())||"",l=(null===(a=b.current)||void 0===a?void 0:null===(n=a.value)||void 0===n?void 0:n.trim())||void 0;if(!r)return;let d=crypto.randomUUID();await o.mutateAsync({id:d,name:r,description:l}),g.current&&(g.current.value=""),b.current&&(b.current.value=""),await i.refetch()},j=async e=>{await l.mutateAsync({id:e}),await i.refetch()};return(0,a.jsxs)("main",{style:{padding:16},children:[(0,a.jsx)("h1",{style:{fontSize:18,marginBottom:12},children:"BORT Command Center (Next)"}),(0,a.jsxs)("section",{style:{marginBottom:12},children:[(0,a.jsx)("input",{ref:g,placeholder:"Bot name",style:{marginRight:8}}),(0,a.jsx)("input",{ref:b,placeholder:"Description",style:{marginRight:8}}),(0,a.jsx)("button",{onClick:x,children:"Create"})]}),(0,a.jsx)("section",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(360px, 1fr))",gap:12},children:null===(e=i.data)||void 0===e?void 0:e.map(e=>(0,a.jsxs)("div",{style:{border:"1px solid #333",borderRadius:6,padding:8},children:[(0,a.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontWeight:600},children:e.name}),(0,a.jsx)("div",{style:{fontSize:12,opacity:.7},children:e.description})]}),(0,a.jsx)("button",{onClick:()=>j(e.id),style:{color:"#ff5252"},children:"Delete"})]}),(0,a.jsx)("div",{style:{marginTop:8},children:(0,a.jsx)(h,{bot:e,onSave:async t=>{await d.mutateAsync({id:e.id,specs:t}),await i.refetch()},onCalibrate:async()=>s.mutateAsync({id:e.id}),calibration:s.data})}),(0,a.jsx)("div",{style:{marginTop:8},children:(0,a.jsx)(y,{plateW:e.specs.printer.basePlateMm.w/10,plateD:e.specs.printer.basePlateMm.d/10,height:e.specs.printer.enclosureCm.h,botName:e.name})}),(0,a.jsxs)("div",{style:{marginTop:8,borderTop:"1px solid #222",paddingTop:8},children:[(0,a.jsx)("div",{style:{fontSize:12,opacity:.7,marginBottom:4},children:"Program (Python)"}),(0,a.jsx)("textarea",{id:"prog-".concat(e.id),defaultValue:"print('Hello from BORTtheBOT')\n",style:{width:"100%",minHeight:120,background:"transparent",color:"inherit",border:"1px solid #333",borderRadius:4,padding:6,fontFamily:"monospace",fontSize:12}}),(0,a.jsxs)("div",{style:{display:"flex",gap:8,marginTop:6},children:[(0,a.jsx)("button",{onClick:async()=>{var t,n;let i=null!==(n=null===(t=document.getElementById("prog-".concat(e.id)))||void 0===t?void 0:t.value)&&void 0!==n?n:"",a=crypto.randomUUID();await u.mutateAsync({id:a,botId:e.id,language:"python",code:i}),alert("Saved program")},children:"Save Program"}),(0,a.jsx)("button",{onClick:async()=>{var t,n,i;let a=null!==(n=null===(t=document.getElementById("prog-".concat(e.id)))||void 0===t?void 0:t.value)&&void 0!==n?n:"",r=crypto.randomUUID();await u.mutateAsync({id:r,botId:e.id,language:"python",code:a});let o=await m.mutateAsync({id:r});window.location.href="".concat(null!==(i=p.env.NEXT_PUBLIC_SERVER_URL)&&void 0!==i?i:"http://localhost:3000","/programs/").concat(o.token)},children:"Download .py"})]})]})]},e.id))})]})}function b(){let e=new l.S;return(0,a.jsx)(d.aH,{client:e,children:(0,a.jsx)(g,{})})}}},function(e){e.O(0,[858,198,75,744],function(){return e(e.s=2651)}),_N_E=e.O()}]);